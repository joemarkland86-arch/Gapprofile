<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GAP Profile™ — Joe Markland Career Coaching</title>
  <meta name="description" content="The GAP Profile™ diagnostic — find out precisely why you're not acting on what you already know. Four evidence-based dimensions. 12 minutes. One specific intervention." />
  <meta property="og:title" content="GAP Profile™" />
  <meta property="og:description" content="You already know what you should do. So why aren't you doing it?" />
  <meta property="og:type" content="website" />

  <!-- React 18 (production, minified) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Recharts 2 -->
  <script src="https://unpkg.com/recharts@2.12.7/umd/Recharts.js"></script>

  <style>
    html, body, #root {
      margin: 0; padding: 0;
      min-height: 100vh;
      background: #0D1B2A;
    }
    #loading {
      position: fixed; inset: 0;
      background: #0D1B2A;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      z-index: 9999;
      transition: opacity 0.4s ease;
    }
    #loading.fade { opacity: 0; pointer-events: none; }
    .ld-ring {
      width: 52px; height: 52px;
      border: 3px solid #2A4060;
      border-top-color: #2EC4B6;
      border-radius: 50%;
      animation: ldspin 0.8s linear infinite;
      margin-bottom: 20px;
    }
    @keyframes ldspin { to { transform: rotate(360deg); } }
    .ld-txt { font-family: Georgia, serif; font-size: 18px; color: #8BA3BC; }
    .ld-sub { font-family: sans-serif; font-size: 12px; color: #4A6580; margin-top: 8px; }
  </style>
</head>
<body>
  <div id="loading">
    <div class="ld-ring"></div>
    <p class="ld-txt">GAP Profile™</p>
    <p class="ld-sub">Loading diagnostic…</p>
  </div>
  <div id="root"></div>

  <script>
    // Destructure from CDN globals - no module system needed
    const { useState, useEffect, useReducer, useRef } = React;
    const { RadarChart, Radar, PolarGrid, PolarAngleAxis, PolarRadiusAxis, ResponsiveContainer } = Recharts;

// ─── COLOUR TOKENS ─────────────────────────────────────────────────────────────
const C = {
    ink: "#0D1B2A",
    surface: "#132031",
    surf2: "#1A2D42",
    border: "#2A4060",
    teal: "#2EC4B6",
    blue: "#3B82F6",
    indigo: "#6366F1",
    purple: "#8B5CF6",
    amber: "#F59E0B",
    text: "#E8EFF6",
    muted: "#8BA3BC",
    dim: "#4A6580",
    green: "#10B981",
    red: "#EF4444",
};
// ─── ARCHETYPES ────────────────────────────────────────────────────────────────
const ARCHETYPES = {
    se: {
        label: "The Capable Doubter", color: C.teal,
        insight: "Has the skills. Has the plan. Still asks — 'But am I actually good enough?'",
        focus: "Mastery evidence-building · Reattribution of past successes",
        mechanism: "Low self-efficacy predicts avoidance even when skill is present. The barrier is belief, not capability.",
        theory: "Bandura's self-efficacy theory (1977, 1997)",
        secondaryLine: "has skills but struggles to act on self-belief",
        actions: [
            { title: "Evidence audit", detail: "Compile concrete proof of past capability — not reassurance, receipts. What have you actually done that required similar skills? This isn't a confidence exercise, it's a data collection exercise." },
            { title: "Behavioral experiments", detail: "Design small, specific actions that generate new efficacy data. Not 'put yourself out there' — a particular action with a particular outcome, done by a particular date." },
            { title: "Attribution mapping", detail: "Where is the internal critic getting its ammunition? Map the specific thoughts and identify whether they're based on evidence or assumption." },
            { title: "Implementation intentions (Gollwitzer)", detail: "Link specific triggers to specific actions: 'When X happens, I will do Y.' This removes the decision-making overhead that low efficacy exploits." },
        ]
    },
    ps: {
        label: "The Risk Frozen", color: C.blue,
        insight: "Can see the path. The threat response is louder than the logic.",
        focus: "Threat deconstruction · Cost-of-inaction reframe · Graduated exposure",
        mechanism: "The SCARF threat response activates an away-state. Loss aversion means potential losses loom approximately twice as large as equivalent gains.",
        theory: "Rock's SCARF model (2008) · Kahneman's prospect theory (2011)",
        secondaryLine: "has a heightened threat response overriding rational calculation",
        actions: [
            { title: "Worst-case analysis", detail: "Not reassurance — systematic mapping. What actually happens if this goes wrong? What's the recovery path? Survivability-tested, not dismissed." },
            { title: "Cost-of-inaction calculation", detail: "What is staying stuck actually costing? The threat response only calculates the risk of moving — not the guaranteed cost of staying still. Make that cost explicit." },
            { title: "SCARF domain audit", detail: "Which threat domain is activated — Status, Certainty, Autonomy, Relatedness, or Fairness? The intervention is different for each one." },
            { title: "Graduated exposure", detail: "Design a reversible, low-stakes first step. The goal is to shrink perceived risk, not eliminate it. Each successful small action recalibrates the threat response." },
        ]
    },
    ia: {
        label: "The Identity Stretched", color: C.indigo,
        insight: "The destination exists in their head. The 'future them' hasn't moved in yet.",
        focus: "Future-self narrative construction · Identity testing at low stakes",
        mechanism: "Actions that conflict with current self-concept create identity dissonance. The gap between current and future self predicts procrastination even when motivation is high.",
        theory: "Ibarra's identity work theory (2003) · Markus & Nurius, possible selves (1986)",
        secondaryLine: "is navigating a gap between current identity and where they want to go",
        actions: [
            { title: "Act first, reflect later (Ibarra)", detail: "Identity follows behaviour — it doesn't precede it. Waiting to 'feel like' the future self before acting inverts the process. The intervention is action, then integration." },
            { title: "Small identity experiments", detail: "One action that puts the future self in the room — a conversation, an event, a project. Not a commitment. An experiment with a defined end point." },
            { title: "Narrative reframing", detail: "Who is the character in the story being written? Reframe the transition as a plot development rather than a personality transplant." },
            { title: "Transition social proof", detail: "Find one person who has made this move — ideally from a similar starting point. Not inspiration. Evidence that the path exists and was survivable." },
        ]
    },
    rr: {
        label: "The Empty Tank", color: C.purple,
        insight: "Knows, wants, capable. Context is the problem — not psychology.",
        focus: "Environment redesign · Capacity triage · Support activation",
        mechanism: "Self-regulatory resources are finite and depletable. When depleted by competing demands, effortful career action is the first casualty — not from lack of motivation, but lack of capacity.",
        theory: "Baumeister's ego depletion theory (1998) · Hobfoll's conservation of resources (1989)",
        secondaryLine: "is experiencing genuine resource depletion — context, not character",
        actions: [
            { title: "Resource audit", detail: "Time, energy, money, social support — which is the actual bottleneck? Treating a time problem with energy interventions wastes both. Identify the specific depleted resource first." },
            { title: "Minimum viable action design", detail: "What is the smallest meaningful step that fits the actual available capacity? Not what should be done — what can be done given the real tank level. Start there." },
            { title: "Friction reduction (Thaler & Sunstein)", detail: "Design the environment to make the career action easier than not doing it. Remove steps, reduce decisions, eliminate obstacles before they have to be overcome in the moment." },
            { title: "Support activation", detail: "Who could carry some of this — and hasn't been asked? Identify one person who could provide practical, emotional, or accountability support. The resource constraint may be partly a support gap." },
        ]
    },
};
// ─── QUESTIONS ─────────────────────────────────────────────────────────────────
const SECTIONS = [
    {
        key: "se", label: "Self-Efficacy", abbr: "SE", color: C.teal,
        theory: "Bandura, 1977",
        desc: "How much you believe you can actually execute the next step",
        questions: [
            { id: 1, text: "I have a clear, specific picture of the steps I need to take to move forward in my career." },
            { id: 2, text: "When I imagine taking my next career step, I genuinely believe I have the skills to execute it." },
            { id: 3, text: "I can point to past evidence — real examples — that I've successfully handled challenges like the ones standing between me and the next step." },
            { id: 4, text: "The primary barrier to my next career move is a lack of skill or capability on my part.", rev: true },
            { id: 5, text: "If someone handed me the opportunity tomorrow, I would back myself to deliver." },
        ]
    },
    {
        key: "ps", label: "Psychological Safety", abbr: "PS", color: C.blue,
        theory: "Rock SCARF, 2008 · Kahneman, 2011",
        desc: "Whether your threat response is overriding rational calculation",
        questions: [
            { id: 6, text: "When I think about my next career step, the anxiety I feel is proportionate — it doesn't stop me thinking clearly." },
            { id: 7, text: "The worst-case scenario, if I take action and it doesn't work out, is something I could realistically recover from." },
            { id: 8, text: "Taking action on my career feels threatening to my financial, social, or professional stability right now.", rev: true },
            { id: 9, text: "When I weigh up my options honestly, the potential upside feels bigger than the risk of getting it wrong." },
            { id: 10, text: "I can think through my career options without a strong physical or emotional reaction — dread, shutdown, or avoidance — taking over." },
        ]
    },
    {
        key: "ia", label: "Identity Alignment", abbr: "IA", color: C.indigo,
        theory: "Ibarra, 2003 · Markus & Nurius, 1986",
        desc: "How much the 'future you' lives in your self-concept",
        questions: [
            { id: 11, text: "The version of me that takes this next step feels like a natural extension of who I already am — not a performance." },
            { id: 12, text: "I can picture myself clearly in the role or career situation I say I want. It feels real, not theoretical." },
            { id: 13, text: "To achieve what I say I want, I would have to become a fundamentally different kind of person.", rev: true },
            { id: 14, text: "The people whose opinions matter most to me would recognise and support this direction as 'right' for me." },
            { id: 15, text: "My sense of who I am actively supports — rather than quietly contradicts — the action I know I need to take." },
        ]
    },
    {
        key: "rr", label: "Resource Readiness", abbr: "RR", color: C.purple,
        theory: "Baumeister, 1998 · Hobfoll, 1989",
        desc: "Whether depleted resources — not psychology — are the bottleneck",
        questions: [
            { id: 16, text: "I have enough mental and emotional energy right now to give this career move the sustained attention it requires." },
            { id: 17, text: "My current life circumstances create enough practical space for me to focus on this." },
            { id: 18, text: "Other demands on my time and energy are so overwhelming that career action keeps getting pushed to the bottom of the list.", rev: true },
            { id: 19, text: "I have at least one person in my life who actively supports and encourages this direction for me." },
            { id: 20, text: "The practical barriers between me and the next step — time, money, access, information — feel genuinely surmountable right now." },
        ]
    },
];
const SCALE = [
    { v: 1, label: "Strongly\nDisagree" },
    { v: 2, label: "Disagree" },
    { v: 3, label: "Neutral" },
    { v: 4, label: "Agree" },
    { v: 5, label: "Strongly\nAgree" },
];
// ─── SCORING ENGINE ────────────────────────────────────────────────────────────
const REVERSE = new Set([4, 8, 13, 18]);
function computeScores(responses) {
    var _a;
    const adj = {};
    for (let i = 1; i <= 20; i++) {
        const raw = (_a = responses[i]) !== null && _a !== void 0 ? _a : 3;
        adj[i] = REVERSE.has(i) ? 6 - raw : raw;
    }
    const se_raw = adj[1] + adj[2] + adj[3] + adj[4] + adj[5];
    const ps_raw = adj[6] + adj[7] + adj[8] + adj[9] + adj[10];
    const ia_raw = adj[11] + adj[12] + adj[13] + adj[14] + adj[15];
    const rr_raw = adj[16] + adj[17] + adj[18] + adj[19] + adj[20];
    const toScore = r => Math.round((r / 25) * 100) / 10;
    const se = toScore(se_raw), ps = toScore(ps_raw), ia = toScore(ia_raw), rr = toScore(rr_raw);
    const cgi = Math.round(((se + ps + ia + rr) / 4) * 10) / 10;
    const sorted = [["se", se], ["ps", ps], ["ia", ia], ["rr", rr]].sort((a, b) => a[1] - b[1]);
    const primary = sorted[0][0];
    const secondary = sorted[1][1] < 5.0 ? sorted[1][0] : null;
    const allCritical = se < 5 && ps < 5 && ia < 5 && rr < 5;
    const statusFor = v => v >= 7 ? "resource" : v >= 5 ? "active" : "critical";
    return {
        se, ps, ia, rr, cgi, primary, secondary, allCritical,
        sorted,
        status: { se: statusFor(se), ps: statusFor(ps), ia: statusFor(ia), rr: statusFor(rr) },
        radarData: [
            { dim: "Self-Efficacy", score: se, fullMark: 10 },
            { dim: "Psych Safety", score: ps, fullMark: 10 },
            { dim: "Identity", score: ia, fullMark: 10 },
            { dim: "Resources", score: rr, fullMark: 10 },
        ],
    };
}
// ─── INTERPRETATION ENGINE ─────────────────────────────────────────────────────
const C2_NATURAL = { "<1mo": "less than a month", "1-6mo": "1 to 6 months", "6-12mo": "6 to 12 months", "1yr+": "over a year" };
const C3_NATURAL = { "never": "without yet attempting it", "1-2": "with one or two attempts", "3-5": "across three to five attempts", "6+": "across six or more attempts" };
const C2_LABEL = { "<1mo": "Less than 1 month", "1-6mo": "1–6 months", "6-12mo": "6–12 months", "1yr+": "Over a year" };
const C3_LABEL = { "never": "Never attempted it", "1-2": "Once or twice", "3-5": "Three to five times", "6+": "Six or more times" };
function getPatternInsight(c2, c3) {
    const long = c2 === "6-12mo" || c2 === "1yr+";
    const veryLong = c2 === "1yr+";
    const sixPlus = c3 === "6+";
    const manyAttempts = c3 === "3-5" || sixPlus;
    const never = c3 === "never";
    const few = c3 === "1-2" || never;
    if (!long && never)
        return "This is fresh awareness — the pattern isn't yet entrenched. The intervention window is open.";
    if (!long && manyAttempts)
        return "You've moved quickly to action — which means the barrier isn't motivation or intention. It's something more structural.";
    if (veryLong && sixPlus)
        return "This pattern is entrenched. Multiple failed attempts over a long period creates learned helplessness risk. The coaching approach needs to be highly structured with very small, success-guaranteed first steps.";
    if (veryLong && never)
        return "Long awareness without any action usually indicates a deeper block than surface-level planning. The diagnostic points precisely to where to look.";
    if (long && few && !never)
        return "The gap between knowing and attempting suggests avoidance has become a habit. The intervention needs to address the habit before the action.";
    if (long && manyAttempts)
        return "This pattern is entrenched. Multiple failed attempts over a long period creates learned helplessness risk. The coaching approach needs to be highly structured with very small, success-guaranteed first steps.";
    return "The gap between knowing and attempting suggests avoidance has become a habit. The intervention needs to address the habit before the action.";
}
function buildInterpretation({ c1, c2, c3, primary, secondary }) {
    const arch = ARCHETYPES[primary];
    const c1short = c1.length > 55 ? c1.slice(0, 55).trimEnd() + "…" : c1;
    const c2n = C2_NATURAL[c2] || c2;
    const c3n = C3_NATURAL[c3] || c3;
    const pattern = getPatternInsight(c2, c3);
    const secArch = secondary ? ARCHETYPES[secondary] : null;
    return {
        s1: `When you think about "${c1short}", the data points to ${arch.label} as the primary pattern.`,
        s2: arch.insight + (secArch ? ` Your data also shows a secondary pattern — ${secArch.label}: ${secArch.secondaryLine}.` : ""),
        s3: `After ${c2n} of awareness ${c3n}: ${pattern}`,
    };
}
// ─── STATE / REDUCER ───────────────────────────────────────────────────────────
const INITIAL = {
    step: 0,
    ctx: { c1: "", c2: "", c3: "" },
    responses: {},
    email: "", firstName: "", emailSkipped: false,
    scores: null,
    coachModalOpen: false, coachUnlocked: false, coachPinEntry: "",
    resumeBannerVisible: false,
    toast: null,
    ctxErrors: {},
    shakingFields: new Set(),
};
function reducer(state, action) {
    switch (action.type) {
        case "SET_STEP": return { ...state, step: action.step };
        case "SET_CTX": return { ...state, ctx: { ...state.ctx, ...action.patch }, ctxErrors: {} };
        case "SET_RESPONSE": return { ...state, responses: { ...state.responses, [action.qid]: action.val } };
        case "SET_EMAIL": return { ...state, email: action.email };
        case "SET_FIRSTNAME": return { ...state, firstName: action.firstName };
        case "SKIP_EMAIL": return { ...state, emailSkipped: true, step: 7 };
        case "SUBMIT_EMAIL": return { ...state, step: 7, toast: "✓ We'll send your PDF to " + action.email };
        case "COMPUTE_SCORES": return { ...state, scores: computeScores(state.responses), step: 7 };
        case "OPEN_COACH": return { ...state, coachModalOpen: true, coachUnlocked: false, coachPinEntry: "" };
        case "CLOSE_COACH": return { ...state, coachModalOpen: false, coachUnlocked: false, coachPinEntry: "" };
        case "PIN_CHANGE": return { ...state, coachPinEntry: action.val };
        case "PIN_SUBMIT": return action.val === "2025"
            ? { ...state, coachUnlocked: true }
            : { ...state, toast: "Incorrect PIN", coachPinEntry: "" };
        case "CLEAR_TOAST": return { ...state, toast: null };
        case "SET_RESUME": return { ...state, resumeBannerVisible: action.val };
        case "RESUME_SESSION": return { ...state, ...action.saved, resumeBannerVisible: false };
        case "CTX_ERRORS": return { ...state, ctxErrors: action.errors };
        case "RETAKE": return { ...INITIAL, resumeBannerVisible: false };
        default: return state;
    }
}
// ─── PERSISTENCE ───────────────────────────────────────────────────────────────
const STORAGE_KEY = "gap-profile-v1";
function saveSession(state) {
    try {
        sessionStorage.setItem(STORAGE_KEY, JSON.stringify({
            step: state.step, ctx: state.ctx, responses: state.responses,
            email: state.email, firstName: state.firstName, ts: Date.now(),
        }));
    }
    catch (_) { }
}
function loadSession() {
    try {
        const raw = sessionStorage.getItem(STORAGE_KEY);
        if (!raw)
            return null;
        const data = JSON.parse(raw);
        if (Date.now() - data.ts > 24 * 60 * 60 * 1000)
            return null;
        if (!data.step || data.step < 1)
            return null;
        return data;
    }
    catch (_) {
        return null;
    }
}
function clearSession() {
    try {
        sessionStorage.removeItem(STORAGE_KEY);
    }
    catch (_) { }
}
// ─── CSS INJECTION ─────────────────────────────────────────────────────────────
const GLOBAL_CSS = `
@import url('https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=Inter:wght@300;400;500;600;700&display=swap');
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
html,body{background:#0D1B2A;color:#E8EFF6;font-family:Inter,sans-serif;}
@keyframes fadeUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
@keyframes slideRight{from{opacity:0;transform:translateX(40px)}to{opacity:1;transform:translateX(0)}}
@keyframes scaleIn{from{opacity:0;transform:scale(0.95)}to{opacity:1;transform:scale(1)}}
@keyframes shake{0%,100%{transform:translateX(0)}20%,60%{transform:translateX(-5px)}40%,80%{transform:translateX(5px)}}
@keyframes pulseGlow{0%,100%{box-shadow:0 0 0 0 rgba(46,196,182,0)}50%{box-shadow:0 0 16px 4px rgba(46,196,182,0.25)}}
@keyframes spin{to{transform:rotate(360deg)}}
.g-fu{animation:fadeUp 0.35s ease-out both}
.g-sr{animation:slideRight 0.35s ease-out both}
.g-si{animation:scaleIn 0.28s ease-out both}
.g-shake{animation:shake 0.35s ease}
.g-d1{animation-delay:0.06s}.g-d2{animation-delay:0.12s}.g-d3{animation-delay:0.18s}.g-d4{animation-delay:0.24s}.g-d5{animation-delay:0.30s}
.g-pg{animation:pulseGlow 2.2s ease-in-out infinite}
.g-btn-p{background:#2EC4B6;color:#0D1B2A;border:none;border-radius:8px;padding:14px 28px;font-family:Inter,sans-serif;font-size:15px;font-weight:600;cursor:pointer;transition:background 0.15s,transform 0.1s,box-shadow 0.15s;letter-spacing:-0.01em}
.g-btn-p:hover{background:#28B0A3;transform:translateY(-1px);box-shadow:0 4px 20px rgba(46,196,182,0.28)}
.g-btn-p:active{transform:translateY(0)}
.g-btn-p:disabled{opacity:0.32;cursor:not-allowed;transform:none;box-shadow:none}
.g-btn-g{background:transparent;color:#8BA3BC;border:1px solid #2A4060;border-radius:8px;padding:12px 22px;font-family:Inter,sans-serif;font-size:14px;font-weight:500;cursor:pointer;transition:border-color 0.15s,color 0.15s}
.g-btn-g:hover{border-color:#8BA3BC;color:#E8EFF6}
.g-card{background:#132031;border:1px solid #2A4060;border-radius:16px;padding:28px}
.g-input{width:100%;background:#0D1B2A;border:1.5px solid #2A4060;border-radius:8px;padding:12px 16px;font-family:Inter,sans-serif;font-size:15px;color:#E8EFF6;outline:none;transition:border-color 0.15s;resize:vertical}
.g-input:focus{border-color:#2EC4B6}
.g-input::placeholder{color:#4A6580}
.g-input.g-err{border-color:#EF4444}
.g-pill{padding:10px 20px;border:1.5px solid #2A4060;border-radius:24px;background:#132031;font-family:Inter,sans-serif;font-size:14px;color:#8BA3BC;cursor:pointer;transition:all 0.15s;white-space:nowrap}
.g-pill:hover{border-color:#4A6580;color:#E8EFF6}
.g-pill.sel{border-color:#2EC4B6;background:rgba(46,196,182,0.1);color:#2EC4B6;font-weight:600}
.g-lk{flex:1;display:flex;flex-direction:column;align-items:center;gap:6px;padding:12px 4px;border:1.5px solid #2A4060;border-radius:10px;background:#132031;cursor:pointer;transition:border-color 0.15s,background 0.15s,transform 0.1s;min-width:0;font-family:Inter,sans-serif}
.g-lk:hover{border-color:#4A6580}
.g-lk:active{transform:scale(0.95)}
.g-lk.sel{border-color:var(--dc);background:var(--dc)}
.g-lk-dot{width:20px;height:20px;border-radius:50%;border:1.5px solid #4A6580;transition:all 0.15s}
.g-lk.sel .g-lk-dot{background:rgba(255,255,255,0.9);border-color:transparent}
.g-lk-lbl{font-size:10px;color:#8BA3BC;text-align:center;line-height:1.2;white-space:pre-line}
.g-lk.sel .g-lk-lbl{color:rgba(255,255,255,0.85)}
.g-mob-lk{display:none}
.g-desk-lk{display:flex;gap:6px}
@media(max-width:640px){
  .g-card{padding:20px;border-radius:12px}
  .g-mob-lk{display:flex;align-items:center;justify-content:space-between;width:100%;gap:4px}
  .g-desk-lk{display:none}
  .g-mc{width:42px;height:42px;border-radius:50%;border:1.5px solid #2A4060;background:#132031;display:flex;align-items:center;justify-content:center;cursor:pointer;font-family:Inter,sans-serif;font-size:14px;font-weight:600;color:#8BA3BC;transition:all 0.15s;flex-shrink:0}
  .g-mc.sel{background:var(--dc);border-color:var(--dc);color:#0D1B2A;font-weight:700}
  .g-mc:active{transform:scale(0.9)}
  .g-mex{font-size:10px;color:#4A6580;flex:1;text-align:center;line-height:1.2}
}
.g-modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.75);backdrop-filter:blur(6px);display:flex;align-items:center;justify-content:center;z-index:1000;padding:20px}
.g-modal{background:#132031;border:1px solid #2A4060;border-radius:20px;padding:32px;max-width:580px;width:100%;max-height:85vh;overflow-y:auto;animation:scaleIn 0.25s ease}
.g-toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%);background:#1A2D42;border:1px solid #2A4060;border-radius:8px;padding:12px 22px;font-family:Inter,sans-serif;font-size:14px;color:#E8EFF6;z-index:900;animation:fadeUp 0.25s ease;pointer-events:none;white-space:nowrap}
.g-bar-fill{height:100%;border-radius:3px;transition:width 0.8s cubic-bezier(0.25,0.46,0.45,0.94)}
.g-acc{overflow:hidden;transition:max-height 0.35s ease,opacity 0.35s ease}
`;
// ─── HOOKS ─────────────────────────────────────────────────────────────────────
function useIsMobile() {
    const [m, setM] = useState(() => typeof window !== "undefined" && window.innerWidth < 640);
    useEffect(() => {
        const h = () => setM(window.innerWidth < 640);
        window.addEventListener("resize", h);
        return () => window.removeEventListener("resize", h);
    }, []);
    return m;
}
function useCGICountUp(target, duration = 1200) {
    const [val, setVal] = useState(0);
    const rafRef = useRef(null);
    useEffect(() => {
        if (!target)
            return;
        let start = null;
        const step = (ts) => {
            if (!start)
                start = ts;
            const elapsed = ts - start;
            const progress = Math.min(elapsed / duration, 1);
            const eased = 1 - Math.pow(1 - progress, 3); // ease-out cubic
            setVal(Math.round(eased * target * 10) / 10);
            if (progress < 1)
                rafRef.current = requestAnimationFrame(step);
        };
        rafRef.current = requestAnimationFrame(step);
        return () => { if (rafRef.current)
            cancelAnimationFrame(rafRef.current); };
    }, [target, duration]);
    return val;
}
// ─── STATUS BADGE ───────────────────────────────────────────────────────────────
function StatusBadge({ status }) {
    const map = {
        resource: { bg: "rgba(16,185,129,0.15)", color: C.green, label: "RESOURCE" },
        active: { bg: "rgba(245,158,11,0.15)", color: C.amber, label: "ACTIVE GAP" },
        critical: { bg: "rgba(239,68,68,0.15)", color: C.red, label: "CRITICAL GAP" },
    };
    const s = map[status] || map.active;
    return (React.createElement("span", { style: { display: "inline-block", padding: "3px 10px", borderRadius: 20,
            fontSize: 10, fontWeight: 700, letterSpacing: "0.07em",
            background: s.bg, color: s.color } }, s.label));
}
// ─── TOAST ─────────────────────────────────────────────────────────────────────
function Toast({ message, onDone }) {
    useEffect(() => {
        const t = setTimeout(onDone, 3000);
        return () => clearTimeout(t);
    }, [onDone]);
    return React.createElement("div", { className: "g-toast" }, message);
}
// ─── TOP NAV ───────────────────────────────────────────────────────────────────
function TopNav({ step, isMobile }) {
    const steps = ["Context", "Self-Efficacy", "Psych Safety", "Identity", "Resources"];
    const activeLabel = step >= 1 && step <= 5 ? steps[step - 1] : "";
    const pct = step === 0 ? 0 : step >= 6 ? 100 : Math.round((step / 5) * 100);
    return (React.createElement("div", { style: { position: "sticky", top: 0, zIndex: 100, background: C.ink,
            borderBottom: `1px solid ${C.border}`, padding: "0 24px", height: 52,
            display: "flex", alignItems: "center", justifyContent: "space-between", gap: 16 } },
        React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 10, flexShrink: 0 } },
            React.createElement("div", { style: { width: 30, height: 30, borderRadius: 8, background: C.teal,
                    display: "flex", alignItems: "center", justifyContent: "center",
                    fontSize: 16, color: C.ink, fontWeight: 700 } }, "\u25C8"),
            React.createElement("span", { style: { fontFamily: "Instrument Serif, Georgia, serif", fontSize: 16,
                    color: C.text, display: isMobile ? "none" : "block" } }, "GAP Profile\u2122")),
        step > 0 && step <= 5 && (React.createElement("div", { style: { flex: 1, maxWidth: 340, margin: "0 16px" } },
            React.createElement("div", { style: { display: "flex", justifyContent: "space-between", marginBottom: 5 } },
                React.createElement("span", { style: { fontSize: 11, color: C.muted } }, activeLabel),
                React.createElement("span", { style: { fontSize: 11, color: C.teal, fontWeight: 600 } },
                    "Step ",
                    step,
                    " of 5")),
            React.createElement("div", { style: { height: 3, background: C.border, borderRadius: 2 } },
                React.createElement("div", { style: { height: "100%", background: C.teal, borderRadius: 2,
                        width: `${pct}%`, transition: "width 0.4s ease" } })))),
        React.createElement("span", { style: { fontSize: 12, color: C.dim, flexShrink: 0,
                display: isMobile ? "none" : "block" } }, "by Joe Markland")));
}
// ─── SCREEN 0: LANDING ─────────────────────────────────────────────────────────
function ScreenLanding({ dispatch }) {
    return (React.createElement("div", { style: { maxWidth: 720, margin: "0 auto", padding: "72px 24px 80px", textAlign: "center" } },
        React.createElement("div", { className: "g-fu", style: { marginBottom: 32 } },
            React.createElement("span", { style: { fontSize: 11, fontWeight: 700, letterSpacing: "0.12em",
                    color: C.teal, textTransform: "uppercase" } }, "The Proprietary Diagnostic")),
        React.createElement("h1", { className: "g-fu g-d1", style: { fontFamily: "Instrument Serif, Georgia, serif",
                fontSize: "clamp(36px,6vw,58px)", color: C.text, lineHeight: 1.1, marginBottom: 16 } },
            "You already know",
            React.createElement("br", null),
            "what you should do."),
        React.createElement("p", { className: "g-fu g-d2", style: { fontFamily: "Instrument Serif, Georgia, serif",
                fontSize: "clamp(20px,3vw,28px)", color: C.muted, fontStyle: "italic", marginBottom: 36 } }, "So why aren't you doing it?"),
        React.createElement("p", { className: "g-fu g-d2", style: { fontSize: 15, color: C.muted, maxWidth: 520,
                margin: "0 auto 40px", lineHeight: 1.75 } }, "Most career tools tell you what kind of person you are. The GAP Profile\u2122 tells you something more useful \u2014 precisely why you're not acting on what you already know. Four evidence-based dimensions. Twelve minutes. One specific intervention."),
        React.createElement("div", { className: "g-fu g-d3", style: { display: "flex", gap: 10, justifyContent: "center",
                flexWrap: "wrap", marginBottom: 48 } }, ["⏱ 12 minutes", "◈ Visual profile", "⚡ 1–2 interventions (not 15)"].map(label => (React.createElement("span", { key: label, style: { padding: "8px 18px", border: `1px solid ${C.border}`,
                borderRadius: 20, fontSize: 13, color: C.muted, background: C.surface } }, label)))),
        React.createElement("div", { className: "g-fu g-d3" },
            React.createElement("button", { className: "g-btn-p", style: { fontSize: 16, padding: "16px 44px", marginBottom: 14 }, onClick: () => dispatch({ type: "SET_STEP", step: 1 }) }, "Identify my GAP \u2192"),
            React.createElement("p", { style: { fontSize: 11, color: C.dim } }, "No account required \u00B7 Results generated instantly \u00B7 Used with early-career professionals across the UK")),
        React.createElement("div", { className: "g-fu g-d4", style: { marginTop: 72, maxWidth: 600, margin: "72px auto 0" } },
            React.createElement("p", { style: { fontSize: 11, fontWeight: 700, letterSpacing: "0.1em", color: C.dim,
                    textTransform: "uppercase", marginBottom: 20 } }, "What makes this different"),
            React.createElement("div", { style: { background: C.surface, border: `1px solid ${C.border}`, borderRadius: 14 } }, [
                ["Other career tools ask…", "GAP Profile™ asks…"],
                ['"What are your skills?"', '"Why aren\'t you using them?"'],
                ['"What are your values?"', '"What\'s stopping you acting on them?"'],
                ['"What do you want?"', '"What\'s between you and it?"'],
            ].map(([left, right], i) => (React.createElement("div", { key: i, style: { display: "grid", gridTemplateColumns: "1fr 1fr",
                    borderBottom: i < 3 ? `1px solid ${C.border}` : "none" } },
                React.createElement("div", { style: { padding: "14px 20px", fontSize: i === 0 ? 11 : 14,
                        color: i === 0 ? C.dim : C.muted, fontWeight: i === 0 ? 700 : 400,
                        textTransform: i === 0 ? "uppercase" : "none", letterSpacing: i === 0 ? "0.07em" : 0,
                        borderRight: `1px solid ${C.border}` } }, left),
                React.createElement("div", { style: { padding: "14px 20px", fontSize: i === 0 ? 11 : 14,
                        color: i === 0 ? C.teal : C.text, fontWeight: i === 0 ? 700 : 500,
                        textTransform: i === 0 ? "uppercase" : "none", letterSpacing: i === 0 ? "0.07em" : 0 } }, right)))))),
        React.createElement("p", { className: "g-fu g-d5", style: { marginTop: 40, fontSize: 12, color: C.dim, lineHeight: 1.8 } },
            "Built on Bandura's self-efficacy theory \u00B7 Rock's SCARF model",
            React.createElement("br", null),
            "Ibarra's identity work research \u00B7 Baumeister's ego depletion studies")));
}
// ─── SCREEN 1: CONTEXT ─────────────────────────────────────────────────────────
function ScreenContext({ ctx, ctxErrors, dispatch }) {
    const [localC1, setLocalC1] = useState(ctx.c1);
    const charCount = localC1.trim().length;
    const handleNext = () => {
        const errors = {};
        if (charCount < 8)
            errors.c1 = "Be more specific — what exactly would you do?";
        if (!ctx.c2)
            errors.c2 = true;
        if (!ctx.c3)
            errors.c3 = true;
        if (Object.keys(errors).length > 0) {
            dispatch({ type: "CTX_ERRORS", errors });
            return;
        }
        dispatch({ type: "SET_CTX", patch: { c1: localC1 } });
        dispatch({ type: "SET_STEP", step: 2 });
    };
    const isValid = charCount >= 8 && ctx.c2 && ctx.c3;
    return (React.createElement("div", { style: { maxWidth: 680, margin: "0 auto", padding: "40px 24px 80px" } },
        React.createElement("div", { className: "g-fu", style: { marginBottom: 32 } },
            React.createElement("p", { style: { fontSize: 11, fontWeight: 700, letterSpacing: "0.1em",
                    color: C.teal, textTransform: "uppercase", marginBottom: 10 } }, "Step 1 of 5 \u2014 Context"),
            React.createElement("h2", { style: { fontFamily: "Instrument Serif, Georgia, serif", fontSize: 28,
                    color: C.text, marginBottom: 8 } }, "What are we looking at?"),
            React.createElement("p", { style: { fontSize: 14, color: C.muted, lineHeight: 1.6 } }, "These three questions anchor the diagnostic to something real. Vague inputs produce vague insights. Be specific about the actual action \u2014 not the general direction.")),
        React.createElement("div", { className: "g-card g-fu g-d1", style: { display: "flex", flexDirection: "column", gap: 28 } },
            React.createElement("div", null,
                React.createElement("label", { style: { display: "block", fontSize: 13, fontWeight: 600,
                        color: C.muted, marginBottom: 8 } }, "The specific action I know I should be taking but am not is:"),
                React.createElement("textarea", { className: `g-input${ctxErrors.c1 ? " g-err" : ""}`, style: { minHeight: 90 }, value: localC1, placeholder: "Be precise. 'Apply for jobs' is too broad. 'Send two speculative emails to companies in X sector this week' is specific enough to diagnose.", onChange: e => {
                        setLocalC1(e.target.value);
                        dispatch({ type: "SET_CTX", patch: { c1: e.target.value } });
                    } }),
                React.createElement("div", { style: { display: "flex", justifyContent: "space-between", marginTop: 5 } },
                    ctxErrors.c1
                        ? React.createElement("span", { style: { fontSize: 12, color: C.red } }, ctxErrors.c1)
                        : React.createElement("span", null),
                    React.createElement("span", { style: { fontSize: 12, color: charCount >= 8 ? C.teal : C.dim } },
                        charCount,
                        " characters",
                        charCount < 8 ? ` (${8 - charCount} more needed)` : ""))),
            React.createElement("div", null,
                React.createElement("label", { style: { display: "block", fontSize: 13, fontWeight: 600,
                        color: C.muted, marginBottom: 12 } }, "I have been aware of this gap for approximately:"),
                React.createElement("div", { style: { display: "flex", flexWrap: "wrap", gap: 8 } }, [["<1mo", "Less than 1 month"], ["1-6mo", "1–6 months"], ["6-12mo", "6–12 months"], ["1yr+", "Over a year"]].map(([v, l]) => (React.createElement("button", { key: v, className: `g-pill${ctx.c2 === v ? " sel" : ""}`, onClick: () => dispatch({ type: "SET_CTX", patch: { c2: v } }) }, l)))),
                ctxErrors.c2 && React.createElement("p", { style: { fontSize: 12, color: C.red, marginTop: 6 } }, "Please select one")),
            React.createElement("div", null,
                React.createElement("label", { style: { display: "block", fontSize: 13, fontWeight: 600,
                        color: C.muted, marginBottom: 12 } }, "I have attempted to close this gap how many times?"),
                React.createElement("div", { style: { display: "flex", flexWrap: "wrap", gap: 8 } }, [["never", "Never"], ["1-2", "Once or twice"], ["3-5", "Three to five times"], ["6+", "Six or more times"]].map(([v, l]) => (React.createElement("button", { key: v, className: `g-pill${ctx.c3 === v ? " sel" : ""}`, onClick: () => dispatch({ type: "SET_CTX", patch: { c3: v } }) }, l)))),
                ctxErrors.c3 && React.createElement("p", { style: { fontSize: 12, color: C.red, marginTop: 6 } }, "Please select one"))),
        React.createElement("div", { style: { display: "flex", justifyContent: "flex-end", marginTop: 24 } },
            React.createElement("button", { className: "g-btn-p", disabled: !isValid, onClick: handleNext }, "Continue \u2192 Self-Efficacy"))));
}
// ─── SCREENS 2–5: QUESTION SECTIONS ────────────────────────────────────────────
function LikertButtons({ qid, value, dimColor, onChange, isMobile }) {
    return (React.createElement(React.Fragment, null,
        React.createElement("div", { className: "g-desk-lk", style: { "--dc": dimColor } }, SCALE.map(s => (React.createElement("button", { key: s.v, className: `g-lk${value === s.v ? " sel" : ""}`, style: { "--dc": dimColor }, onClick: () => onChange(qid, s.v) },
            React.createElement("div", { className: "g-lk-dot" }),
            React.createElement("span", { className: "g-lk-lbl" }, s.label))))),
        React.createElement("div", { className: "g-mob-lk", style: { "--dc": dimColor } },
            React.createElement("span", { className: "g-mex" },
                "Strongly",
                React.createElement("br", null),
                "Disagree"),
            [1, 2, 3, 4, 5].map(v => (React.createElement("div", { key: v, className: `g-mc${value === v ? " sel" : ""}`, style: { "--dc": dimColor }, onClick: () => onChange(qid, v) }, v))),
            React.createElement("span", { className: "g-mex" },
                "Strongly",
                React.createElement("br", null),
                "Agree"))));
}
function ScreenSection({ section, stepIdx, responses, dispatch, isMobile }) {
    const answered = section.questions.filter(q => responses[q.id] != null).length;
    const allAnswered = answered === 5;
    const nextSection = stepIdx < 3 ? SECTIONS[stepIdx + 1] : null;
    const scrollToFirst = () => {
        const first = section.questions.find(q => responses[q.id] == null);
        if (!first)
            return;
        const el = document.getElementById(`q-${first.id}`);
        if (el)
            el.scrollIntoView({ behavior: "smooth", block: "center" });
    };
    const handleNext = () => {
        if (!allAnswered) {
            scrollToFirst();
            return;
        }
        if (stepIdx < 3)
            dispatch({ type: "SET_STEP", step: stepIdx + 3 });
        else
            dispatch({ type: "SET_STEP", step: 6 }); // → email capture
    };
    return (React.createElement("div", { style: { maxWidth: 700, margin: "0 auto", padding: "32px 24px 80px" } },
        React.createElement("div", { className: "g-fu g-card", style: { borderLeft: `4px solid ${section.color}`,
                marginBottom: 24, display: "flex", alignItems: "center", gap: 16 } },
            React.createElement("div", { style: { width: 44, height: 44, borderRadius: 10, background: section.color,
                    display: "flex", alignItems: "center", justifyContent: "center", flexShrink: 0 } },
                React.createElement("span", { style: { color: C.ink, fontWeight: 800, fontSize: 13 } }, section.abbr)),
            React.createElement("div", { style: { flex: 1 } },
                React.createElement("p", { style: { fontSize: 11, color: C.dim, fontWeight: 700, letterSpacing: "0.08em",
                        textTransform: "uppercase", marginBottom: 3 } }, section.theory),
                React.createElement("h2", { style: { fontFamily: "Instrument Serif, Georgia, serif", fontSize: 22,
                        color: C.text, marginBottom: 2 } }, section.label),
                React.createElement("p", { style: { fontSize: 13, color: C.muted } }, section.desc))),
        React.createElement("div", { style: { display: "flex", flexDirection: "column", gap: 14 } }, section.questions.map((q, qi) => {
            const isAnswered = responses[q.id] != null;
            return (React.createElement("div", { key: q.id, id: `q-${q.id}`, className: `g-card g-fu g-d${qi + 1}`, style: { borderColor: !isAnswered ? C.border : section.color + "60" } },
                React.createElement("div", { style: { display: "flex", gap: 12, marginBottom: 18 } },
                    React.createElement("div", { style: { width: 28, height: 28, borderRadius: 6, background: section.color,
                            display: "flex", alignItems: "center", justifyContent: "center", flexShrink: 0 } },
                        React.createElement("span", { style: { color: C.ink, fontWeight: 700, fontSize: 12 } }, q.id)),
                    React.createElement("p", { style: { fontSize: 14, color: C.text, lineHeight: 1.65, flex: 1 } },
                        q.text,
                        q.rev && (React.createElement("span", { title: "This question is scored in reverse to prevent response bias", style: { marginLeft: 8, fontSize: 10, color: C.dim, fontWeight: 700,
                                letterSpacing: "0.06em", cursor: "help" } }, "[R]")))),
                React.createElement(LikertButtons, { qid: q.id, value: responses[q.id], dimColor: section.color, onChange: (id, v) => dispatch({ type: "SET_RESPONSE", qid: id, val: v }), isMobile: isMobile })));
        })),
        React.createElement("div", { style: { display: "flex", justifyContent: "space-between", alignItems: "center", marginTop: 24 } },
            React.createElement("button", { className: "g-btn-g", onClick: () => dispatch({ type: "SET_STEP", step: stepIdx + 1 }) }, "\u2190 Back"),
            React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 16 } },
                React.createElement("span", { style: { fontSize: 13, color: allAnswered ? C.teal : C.muted } },
                    answered,
                    " of 5 answered"),
                React.createElement("button", { className: "g-btn-p", onClick: handleNext }, stepIdx < 3 ? `Continue → ${nextSection.label}` : "Calculate my profile →")))));
}
// ─── SCREEN 6: EMAIL CAPTURE ────────────────────────────────────────────────────
function ScreenEmail({ email, firstName, dispatch }) {
    const [localEmail, setLocalEmail] = useState(email);
    const [localName, setLocalName] = useState(firstName);
    const [emailErr, setEmailErr] = useState("");
    const [submitted, setSubmitted] = useState(false);
    const isValidEmail = v => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);
    const handleSubmit = () => {
        if (localEmail && !isValidEmail(localEmail)) {
            setEmailErr("Please enter a valid email address");
            return;
        }
        if (localEmail) {
            setSubmitted(true);
            setTimeout(() => {
                dispatch({ type: "SET_EMAIL", email: localEmail });
                dispatch({ type: "SET_FIRSTNAME", firstName: localName });
                dispatch({ type: "COMPUTE_SCORES" });
            }, 1800);
        }
        else {
            dispatch({ type: "COMPUTE_SCORES" });
        }
    };
    return (React.createElement("div", { style: { minHeight: "calc(100vh - 52px)", display: "flex", alignItems: "center",
            justifyContent: "center", padding: "40px 24px" } },
        React.createElement("div", { style: { maxWidth: 480, width: "100%", textAlign: "center" } },
            React.createElement("div", { className: "g-fu", style: { marginBottom: 28 } },
                React.createElement("div", { style: { fontSize: 56, color: C.teal, marginBottom: 24 } }, "\u25C8"),
                React.createElement("h2", { style: { fontFamily: "Instrument Serif, Georgia, serif", fontSize: 32,
                        color: C.text, marginBottom: 10 } }, "Your profile is ready."),
                React.createElement("p", { style: { fontSize: 15, color: C.muted, lineHeight: 1.6 } }, "Where should we send your personalised results PDF?")),
            submitted ? (React.createElement("div", { className: "g-fu g-card", style: { textAlign: "center", padding: "32px" } },
                React.createElement("div", { style: { fontSize: 36, marginBottom: 12 } }, "\u2713"),
                React.createElement("p", { style: { fontSize: 16, color: C.teal, fontWeight: 600, marginBottom: 6 } },
                    "We'll email your PDF to ",
                    localEmail),
                React.createElement("p", { style: { fontSize: 13, color: C.muted } }, "Loading your results\u2026"))) : (React.createElement("div", { className: "g-fu g-d1 g-card", style: { textAlign: "left", marginBottom: 20 } },
                React.createElement("div", { style: { display: "flex", flexDirection: "column", gap: 14, marginBottom: 20 } },
                    React.createElement("div", null,
                        React.createElement("label", { style: { display: "block", fontSize: 12, color: C.muted,
                                fontWeight: 600, marginBottom: 6 } }, "First name"),
                        React.createElement("input", { className: "g-input", type: "text", value: localName, placeholder: "e.g. Alex", onChange: e => setLocalName(e.target.value), style: { minHeight: "auto", resize: "none" } })),
                    React.createElement("div", null,
                        React.createElement("label", { style: { display: "block", fontSize: 12, color: C.muted,
                                fontWeight: 600, marginBottom: 6 } }, "Email address"),
                        React.createElement("input", { className: "g-input", type: "email", value: localEmail, placeholder: "you@example.com", onChange: e => { setLocalEmail(e.target.value); setEmailErr(""); }, style: { minHeight: "auto", resize: "none" } }),
                        emailErr && React.createElement("p", { style: { fontSize: 12, color: C.red, marginTop: 5 } }, emailErr))),
                React.createElement("button", { className: "g-btn-p", style: { width: "100%", marginBottom: 14 }, onClick: handleSubmit }, "Show me my results \u2192"),
                React.createElement("p", { style: { fontSize: 11, color: C.dim, textAlign: "center", marginBottom: 14, lineHeight: 1.6 } }, "One email with your PDF. No newsletter. No spam. Unsubscribe any time."),
                React.createElement("p", { style: { textAlign: "center" } },
                    React.createElement("button", { onClick: () => dispatch({ type: "SKIP_EMAIL" }), style: { background: "none", border: "none", fontSize: 12,
                            color: C.dim, cursor: "pointer", textDecoration: "underline" } }, "Skip \u2014 just show me the results")))))));
}
// ─── CUSTOM RADAR TICK ─────────────────────────────────────────────────────────
function RadarTick({ x, y, payload }) {
    const words = payload.value.split(" ");
    return (React.createElement("g", { transform: `translate(${x},${y})` }, words.map((w, i) => (React.createElement("text", { key: i, x: 0, y: (i - (words.length - 1) / 2) * 14, textAnchor: "middle", fill: C.muted, fontSize: 11, fontFamily: "Inter, sans-serif", fontWeight: 500 }, w)))));
}
// ─── CGI RING ──────────────────────────────────────────────────────────────────
function CGIRing({ cgi }) {
    const displayed = useCGICountUp(cgi);
    const r = 62;
    const circ = 2 * Math.PI * r;
    const color = cgi >= 7 ? C.green : cgi >= 5 ? C.amber : C.red;
    return (React.createElement("div", { style: { display: "flex", flexDirection: "column", alignItems: "center", gap: 10 } },
        React.createElement("div", { style: { position: "relative", width: 150, height: 150 } },
            React.createElement("svg", { width: "150", height: "150", viewBox: "0 0 150 150", style: { transform: "rotate(-90deg)" } },
                React.createElement("circle", { cx: "75", cy: "75", r: r, fill: "none", stroke: C.border, strokeWidth: "10" }),
                React.createElement("circle", { cx: "75", cy: "75", r: r, fill: "none", stroke: color, strokeWidth: "10", strokeDasharray: `${circ}`, strokeDashoffset: circ * (1 - cgi / 10), strokeLinecap: "round", style: { transition: "stroke-dashoffset 1.2s cubic-bezier(0.25,0.46,0.45,0.94)" } })),
            React.createElement("div", { style: { position: "absolute", inset: 0, display: "flex",
                    flexDirection: "column", alignItems: "center", justifyContent: "center" } },
                React.createElement("span", { style: { fontFamily: "Instrument Serif, Georgia, serif",
                        fontSize: 34, color: C.text, lineHeight: 1, fontWeight: 600 } }, displayed.toFixed(1)),
                React.createElement("span", { style: { fontSize: 10, color: C.muted, marginTop: 3 } }, "/ 10"))),
        React.createElement("div", { style: { textAlign: "center" } },
            React.createElement("p", { style: { fontSize: 12, fontWeight: 700, color: C.muted, letterSpacing: "0.08em", textTransform: "uppercase" } }, "Composite Gap Index"),
            React.createElement("p", { style: { fontSize: 11, color: C.dim } }, "Your overall action potential score"))));
}
// ─── ACCORDION ─────────────────────────────────────────────────────────────────
function Accordion({ title, children }) {
    const [open, setOpen] = useState(false);
    return (React.createElement("div", { style: { background: C.surface, border: `1px solid ${C.border}`, borderRadius: 14 } },
        React.createElement("button", { onClick: () => setOpen(!open), style: { width: "100%", padding: "20px 24px", background: "none", border: "none",
                display: "flex", justifyContent: "space-between", alignItems: "center",
                cursor: "pointer", textAlign: "left" } },
            React.createElement("span", { style: { fontSize: 15, fontWeight: 600, color: C.text } }, title),
            React.createElement("span", { style: { fontSize: 18, color: C.muted, transform: open ? "rotate(180deg)" : "none",
                    transition: "transform 0.3s" } }, "\u2304")),
        React.createElement("div", { className: "g-acc", style: { maxHeight: open ? 600 : 0, opacity: open ? 1 : 0 } },
            React.createElement("div", { style: { padding: "0 24px 24px" } }, children))));
}
// ─── COACH MODAL ───────────────────────────────────────────────────────────────
function CoachModal({ state, dispatch }) {
    const { scores, ctx, coachUnlocked, coachPinEntry } = state;
    const [pinError, setPinError] = useState(false);
    const handlePin = () => {
        if (coachPinEntry === "2025") {
            dispatch({ type: "PIN_SUBMIT", val: coachPinEntry });
            setPinError(false);
        }
        else {
            setPinError(true);
            setTimeout(() => setPinError(false), 1200);
            dispatch({ type: "PIN_CHANGE", val: "" });
        }
    };
    const arch = scores ? ARCHETYPES[scores.primary] : null;
    const patternNote = scores ? getPatternInsight(ctx.c2, ctx.c3) : "";
    return (React.createElement("div", { className: "g-modal-overlay", onClick: () => dispatch({ type: "CLOSE_COACH" }) },
        React.createElement("div", { className: "g-modal", onClick: e => e.stopPropagation() },
            React.createElement("div", { style: { display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 24 } },
                React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 10 } },
                    React.createElement("span", { style: { color: C.teal, fontSize: 18 } }, "\u25C8"),
                    React.createElement("span", { style: { fontFamily: "Instrument Serif, Georgia, serif", fontSize: 18, color: C.text } }, "Coach View")),
                React.createElement("button", { onClick: () => dispatch({ type: "CLOSE_COACH" }), style: { background: "none", border: "none", color: C.muted,
                        fontSize: 20, cursor: "pointer", lineHeight: 1 } }, "\u00D7")),
            !coachUnlocked ? (React.createElement("div", { style: { textAlign: "center" } },
                React.createElement("p", { style: { fontSize: 14, color: C.muted, marginBottom: 24 } }, "Enter your 4-digit coach PIN to access the clinical interpretation."),
                React.createElement("div", { className: pinError ? "g-shake" : "", style: { maxWidth: 200, margin: "0 auto 16px" } },
                    React.createElement("input", { className: "g-input", type: "password", maxLength: 4, value: coachPinEntry, placeholder: "\u2022 \u2022 \u2022 \u2022", style: { textAlign: "center", fontSize: 24, letterSpacing: "0.4em" }, onChange: e => dispatch({ type: "PIN_CHANGE", val: e.target.value }), onKeyDown: e => e.key === "Enter" && handlePin() })),
                pinError && React.createElement("p", { style: { fontSize: 12, color: C.red, marginBottom: 12 } }, "Incorrect PIN"),
                React.createElement("button", { className: "g-btn-p", onClick: handlePin }, "Unlock"))) : arch && scores ? (React.createElement("div", { style: { display: "flex", flexDirection: "column", gap: 20 } },
                React.createElement("div", { style: { background: C.ink, borderRadius: 10, padding: "16px 20px" } },
                    React.createElement("p", { style: { fontSize: 11, color: C.teal, fontWeight: 700, letterSpacing: "0.08em",
                            textTransform: "uppercase", marginBottom: 10 } }, "Pre-session protocol"),
                    [
                        `Primary: ${arch.label} — lead with ${arch.focus.split("·")[0].trim()}`,
                        `Lowest dimension: ${scores.sorted[0][0].toUpperCase()} (${scores.sorted[0][1].toFixed(1)}/10) — this is your session anchor`,
                        `Duration: ${C2_LABEL[ctx.c2] || ctx.c2}${ctx.c2 === "1yr+" ? " — explore secondary gain" : ""}`,
                        `Attempts: ${C3_LABEL[ctx.c3] || ctx.c3}${ctx.c3 === "6+" ? " — high learned helplessness risk" : ctx.c3 === "never" ? " — explore what has stopped starting" : ""}`,
                        `Pattern: ${patternNote}`,
                    ].map((item, i) => (React.createElement("div", { key: i, style: { display: "flex", gap: 10, marginBottom: 8 } },
                        React.createElement("span", { style: { color: C.teal, fontWeight: 700, fontSize: 12, flexShrink: 0, marginTop: 2 } },
                            i + 1,
                            "."),
                        React.createElement("p", { style: { fontSize: 13, color: C.text, lineHeight: 1.5 } }, item))))),
                React.createElement("div", { style: { background: "rgba(245,158,11,0.08)", border: `1px solid rgba(245,158,11,0.25)`,
                        borderRadius: 10, padding: "16px 20px" } },
                    React.createElement("p", { style: { fontSize: 11, color: C.amber, fontWeight: 700, letterSpacing: "0.08em",
                            textTransform: "uppercase", marginBottom: 8 } }, "Debrief opening"),
                    React.createElement("p", { style: { fontSize: 14, color: C.text, fontStyle: "italic", lineHeight: 1.7 } },
                        "\"Take a moment with this. What do you notice?\" \u2014 then silence. Don't interpret first. Let them name it. Once they engage: \"This dimension \u2014 ",
                        scores.sorted[0][0].toUpperCase(),
                        " \u2014 seems to be the loudest thing in your profile. Tell me more about what it's like in that space.\"")),
                (ctx.c2 === "1yr+" || ctx.c3 === "6+") && (React.createElement("div", { style: { background: "rgba(239,68,68,0.08)", border: `1px solid rgba(239,68,68,0.25)`,
                        borderRadius: 10, padding: "16px 20px" } },
                    React.createElement("p", { style: { fontSize: 11, color: C.red, fontWeight: 700, letterSpacing: "0.08em",
                            textTransform: "uppercase", marginBottom: 8 } }, "\u26A0 Flags"),
                    ctx.c2 === "1yr+" && React.createElement("p", { style: { fontSize: 13, color: C.text, marginBottom: 4, lineHeight: 1.5 } },
                        React.createElement("strong", null, "Long duration:"),
                        " Entrenched pattern. Explore secondary gain before interventions."),
                    ctx.c3 === "6+" && React.createElement("p", { style: { fontSize: 13, color: C.text, lineHeight: 1.5 } },
                        React.createElement("strong", null, "High attempts:"),
                        " Learned helplessness risk. Very small, success-guaranteed first action is critical."))),
                React.createElement("div", null,
                    React.createElement("p", { style: { fontSize: 11, color: C.dim, fontWeight: 700, letterSpacing: "0.08em",
                            textTransform: "uppercase", marginBottom: 10 } }, "Record for client file"),
                    React.createElement("div", { style: { display: "grid", gridTemplateColumns: "1fr 1fr", gap: 8 } }, [
                        ["Intake CGI", `${scores.cgi.toFixed(1)} / 10`],
                        ["SE", `${scores.se.toFixed(1)} / 10`],
                        ["PS", `${scores.ps.toFixed(1)} / 10`],
                        ["IA", `${scores.ia.toFixed(1)} / 10`],
                        ["RR", `${scores.rr.toFixed(1)} / 10`],
                        ["Close CGI", "__ / 10"],
                    ].map(([k, v]) => (React.createElement("div", { key: k, style: { background: C.ink, borderRadius: 8, padding: "10px 14px",
                            display: "flex", justifyContent: "space-between" } },
                        React.createElement("span", { style: { fontSize: 12, color: C.muted, fontWeight: 600 } }, k),
                        React.createElement("span", { style: { fontSize: 13, color: C.text, fontWeight: 700 } }, v)))))),
                React.createElement("p", { style: { fontSize: 11, color: C.dim, textAlign: "center" } }, "Print or screenshot for the client file"))) : null)));
}
// ─── SCREEN 7: RESULTS ─────────────────────────────────────────────────────────
function ScreenResults({ state, dispatch }) {
    const { scores, ctx, firstName, email } = state;
    const [archetypeVisible, setArchetypeVisible] = useState(false);
    const [barsVisible, setBarsVisible] = useState(false);
    useEffect(() => {
        const t1 = setTimeout(() => setArchetypeVisible(true), 400);
        const t2 = setTimeout(() => setBarsVisible(true), 600);
        return () => { clearTimeout(t1); clearTimeout(t2); };
    }, []);
    if (!scores)
        return null;
    const { se, ps, ia, rr, cgi, primary, secondary, allCritical, status, radarData } = scores;
    const arch = ARCHETYPES[primary];
    const secArch = secondary ? ARCHETYPES[secondary] : null;
    const interp = buildInterpretation({ c1: ctx.c1, c2: ctx.c2, c3: ctx.c3, primary, secondary });
    const showLongFlag = ctx.c2 === "1yr+";
    const showAttemptFlag = ctx.c3 === "6+";
    const dimRows = [
        { key: "se", label: "Self-Efficacy", score: se, color: C.teal },
        { key: "ps", label: "Psychological Safety", score: ps, color: C.blue },
        { key: "ia", label: "Identity Alignment", score: ia, color: C.indigo },
        { key: "rr", label: "Resource Readiness", score: rr, color: C.purple },
    ];
    const copyProfile = () => {
        const text = [
            "GAP Profile™ Results",
            `Archetype: ${arch.label}`,
            `Composite Gap Index: ${cgi}/10`,
            `Self-Efficacy: ${se}/10 | Psych Safety: ${ps}/10`,
            `Identity Alignment: ${ia}/10 | Resource Readiness: ${rr}/10`,
            `Action: ${ctx.c1}`,
            "Generated at gapprofile.co.uk",
        ].join("\n");
        navigator.clipboard.writeText(text).catch(() => { });
        dispatch({ type: "CLEAR_TOAST" });
        setTimeout(() => dispatch({ type: "CLEAR_TOAST" }), 10);
        // quick toast via temp state manipulation
    };
    return (React.createElement("div", { style: { maxWidth: 720, margin: "0 auto", padding: "40px 24px 120px" } },
        React.createElement("div", { className: "g-fu", style: { textAlign: "center", marginBottom: 48 } },
            React.createElement("p", { style: { fontSize: 11, fontWeight: 700, letterSpacing: "0.12em",
                    color: C.teal, textTransform: "uppercase", marginBottom: 14 } }, "YOUR GAP PROFILE\u2122"),
            React.createElement("p", { style: { fontSize: 16, color: C.muted, marginBottom: 24 } }, firstName ? `Here's what we found, ${firstName}.` : "Here's what your responses reveal."),
            React.createElement("h1", { style: { fontFamily: "Instrument Serif, Georgia, serif",
                    fontSize: "clamp(36px,6vw,56px)", color: C.text, lineHeight: 1.1,
                    marginBottom: 16, opacity: archetypeVisible ? 1 : 0,
                    transform: archetypeVisible ? "translateY(0)" : "translateY(12px)",
                    transition: "opacity 0.5s ease, transform 0.5s ease" } }, arch.label),
            React.createElement("p", { style: { fontFamily: "Instrument Serif, Georgia, serif", fontSize: "clamp(16px,2.5vw,20px)",
                    color: C.muted, fontStyle: "italic", maxWidth: 560, margin: "0 auto 36px",
                    opacity: archetypeVisible ? 1 : 0, transition: "opacity 0.5s ease 0.15s" } },
                "\"",
                arch.insight,
                "\""),
            React.createElement("div", { style: { background: C.surf2, border: `1px solid ${arch.color}40`,
                    borderLeft: `4px solid ${arch.color}`, borderRadius: 12,
                    padding: "18px 24px", textAlign: "left", maxWidth: 560, margin: "0 auto" } },
                React.createElement("p", { style: { fontSize: 11, color: C.dim, fontWeight: 700, letterSpacing: "0.08em",
                        textTransform: "uppercase", marginBottom: 8 } }, "This diagnostic is anchored to"),
                React.createElement("p", { style: { fontSize: 15, color: C.text, lineHeight: 1.65, marginBottom: 10 } },
                    "\"",
                    ctx.c1,
                    "\""),
                React.createElement("p", { style: { fontSize: 13, color: C.muted } },
                    "Aware for: ",
                    React.createElement("strong", { style: { color: C.text } }, C2_LABEL[ctx.c2]),
                    " · ",
                    "Attempts: ",
                    React.createElement("strong", { style: { color: C.text } }, C3_LABEL[ctx.c3])))),
        React.createElement("div", { className: "g-fu g-d2", style: { display: "grid",
                gridTemplateColumns: "1fr auto", gap: 24, marginBottom: 32, alignItems: "center" } },
            React.createElement("div", { className: "g-card", style: { padding: "20px 10px" } },
                React.createElement(ResponsiveContainer, { width: "100%", height: 280 },
                    React.createElement(RadarChart, { data: radarData, margin: { top: 20, right: 30, bottom: 20, left: 30 } },
                        React.createElement(PolarGrid, { stroke: C.border }),
                        React.createElement(PolarAngleAxis, { dataKey: "dim", tick: React.createElement(RadarTick, null) }),
                        React.createElement(PolarRadiusAxis, { angle: 90, domain: [0, 10], tick: false, axisLine: false }),
                        React.createElement(Radar, { dataKey: "score", stroke: C.teal, fill: C.teal, fillOpacity: 0.2, strokeWidth: 2 }))),
                React.createElement("p", { style: { textAlign: "center", fontSize: 12, color: C.dim, marginTop: 4 } }, "Where the gaps are largest, the barriers are loudest")),
            React.createElement("div", { style: { display: "flex", justifyContent: "center" } },
                React.createElement(CGIRing, { cgi: cgi }))),
        React.createElement("div", { className: "g-fu g-d2 g-card", style: { display: "flex", flexDirection: "column",
                gap: 14, marginBottom: 32 } }, dimRows.map((d, i) => {
            const isPrimary = d.key === primary;
            return (React.createElement("div", { key: d.key, className: isPrimary ? "g-pg" : "", style: { borderRadius: 10, padding: "12px 16px",
                    background: isPrimary ? C.surf2 : "transparent",
                    border: isPrimary ? `1px solid ${d.color}30` : "1px solid transparent",
                    transition: "all 0.3s", transitionDelay: `${i * 0.15}s` } },
                React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 12, marginBottom: 8 } },
                    React.createElement("div", { style: { width: 32, height: 32, borderRadius: 8, background: d.color,
                            display: "flex", alignItems: "center", justifyContent: "center", flexShrink: 0 } },
                        React.createElement("span", { style: { color: C.ink, fontWeight: 800, fontSize: 10 } }, d.key.toUpperCase())),
                    React.createElement("span", { style: { fontSize: 14, fontWeight: 600, color: C.text, flex: 1 } }, d.label),
                    React.createElement("span", { style: { fontSize: 16, fontWeight: 700, color: d.color, marginRight: 8 } }, d.score.toFixed(1)),
                    React.createElement(StatusBadge, { status: status[d.key] })),
                React.createElement("div", { style: { height: 6, background: C.border, borderRadius: 3 } },
                    React.createElement("div", { className: "g-bar-fill", style: { width: barsVisible ? `${d.score * 10}%` : "0%",
                            background: d.color, transitionDelay: `${i * 0.15}s` } })),
                isPrimary && (React.createElement("p", { style: { fontSize: 11, color: d.color, marginTop: 6, fontWeight: 600 } }, "\u2191 Primary gap \u2014 coaching focus here first"))));
        })),
        React.createElement("div", { className: "g-fu g-d3 g-card", style: { borderLeft: `4px solid ${arch.color}`,
                marginBottom: 24 } },
            React.createElement("p", { style: { fontSize: 11, fontWeight: 700, color: arch.color, letterSpacing: "0.08em",
                    textTransform: "uppercase", marginBottom: 10 } }, "What this means for you"),
            React.createElement("h3", { style: { fontFamily: "Instrument Serif, Georgia, serif", fontSize: 20,
                    color: C.text, marginBottom: 14 } },
                "Why \"",
                ctx.c1.length > 50 ? ctx.c1.slice(0, 50) + "…" : ctx.c1,
                "\" keeps not happening"),
            React.createElement("p", { style: { fontSize: 15, color: C.muted, lineHeight: 1.75, marginBottom: 10 } }, interp.s1),
            React.createElement("p", { style: { fontSize: 15, color: C.text, lineHeight: 1.75, marginBottom: 10 } }, interp.s2),
            React.createElement("p", { style: { fontSize: 14, color: C.muted, lineHeight: 1.65, fontStyle: "italic",
                    borderTop: `1px solid ${C.border}`, paddingTop: 12 } }, interp.s3)),
        React.createElement("div", { className: "g-fu g-d3", style: { marginBottom: 24, borderRadius: 16, overflow: "hidden",
                border: `1px solid ${C.border}` } },
            React.createElement("div", { style: { background: arch.color, padding: "20px 28px" } },
                React.createElement("p", { style: { fontSize: 11, color: "rgba(0,0,0,0.5)", fontWeight: 700,
                        letterSpacing: "0.1em", textTransform: "uppercase", marginBottom: 4 } }, "Primary intervention"),
                React.createElement("h3", { style: { fontFamily: "Instrument Serif, Georgia, serif", fontSize: 22,
                        color: C.ink, marginBottom: 4 } }, arch.label),
                React.createElement("p", { style: { fontSize: 13, color: "rgba(0,0,0,0.55)", fontWeight: 600 } }, arch.focus)),
            React.createElement("div", { style: { background: C.surface, padding: "24px 28px",
                    display: "flex", flexDirection: "column", gap: 16 } },
                React.createElement("p", { style: { fontSize: 13, color: C.muted, fontStyle: "italic", lineHeight: 1.5 } }, arch.mechanism),
                arch.actions.map((a, i) => (React.createElement("div", { key: i, style: { display: "flex", gap: 14 } },
                    React.createElement("div", { style: { width: 28, height: 28, borderRadius: 7, background: arch.color,
                            display: "flex", alignItems: "center", justifyContent: "center", flexShrink: 0, marginTop: 1 } },
                        React.createElement("span", { style: { color: C.ink, fontWeight: 800, fontSize: 12 } }, i + 1)),
                    React.createElement("div", null,
                        React.createElement("p", { style: { fontSize: 14, fontWeight: 700, color: C.text, marginBottom: 3 } }, a.title),
                        React.createElement("p", { style: { fontSize: 13, color: C.muted, lineHeight: 1.6 } }, a.detail))))))),
        secArch && (React.createElement("div", { className: "g-fu g-d4 g-card", style: { borderLeft: `4px solid ${secArch.color}`,
                marginBottom: 24 } },
            React.createElement("p", { style: { fontSize: 11, fontWeight: 700, color: secArch.color, letterSpacing: "0.08em",
                    textTransform: "uppercase", marginBottom: 8 } },
                "Secondary pattern \u2014 ",
                secArch.label),
            React.createElement("p", { style: { fontSize: 14, color: C.muted, fontStyle: "italic", marginBottom: 14 } },
                "\"",
                secArch.insight,
                "\""),
            React.createElement("div", { style: { display: "flex", flexDirection: "column", gap: 10 } }, secArch.actions.slice(0, 2).map((a, i) => (React.createElement("div", { key: i, style: { display: "flex", gap: 12, alignItems: "flex-start" } },
                React.createElement("div", { style: { width: 22, height: 22, borderRadius: 5, background: secArch.color,
                        display: "flex", alignItems: "center", justifyContent: "center", flexShrink: 0 } },
                    React.createElement("span", { style: { color: C.ink, fontWeight: 800, fontSize: 11 } }, i + 1)),
                React.createElement("p", { style: { fontSize: 13, color: C.text, lineHeight: 1.6 } },
                    React.createElement("strong", null,
                        a.title,
                        ":"),
                    " ",
                    a.detail))))))),
        (showLongFlag || showAttemptFlag) && (React.createElement("div", { className: "g-fu g-d4", style: { marginBottom: 24, background: "rgba(245,158,11,0.07)",
                border: `1px solid rgba(245,158,11,0.3)`, borderRadius: 14, padding: "20px 24px" } },
            React.createElement("p", { style: { fontSize: 11, fontWeight: 700, color: C.amber, letterSpacing: "0.08em",
                    textTransform: "uppercase", marginBottom: 10 } }, "A note for your coach"),
            showLongFlag && (React.createElement("p", { style: { fontSize: 14, color: C.text, lineHeight: 1.65, marginBottom: 8 } },
                React.createElement("strong", null, "Awareness duration:"),
                " Over a year of knowing and not acting can indicate an entrenched pattern \u2014 and sometimes a secondary gain in staying stuck. This warrants careful exploration before moving to action planning.")),
            showAttemptFlag && (React.createElement("p", { style: { fontSize: 14, color: C.text, lineHeight: 1.65 } },
                React.createElement("strong", null, "Multiple attempts:"),
                " Six or more attempts that haven't landed creates real risk of learned helplessness \u2014 the belief that the action is simply impossible for you. The coaching approach here needs to engineer a guaranteed small win before anything else.")))),
        React.createElement("div", { className: "g-fu g-d4", style: { marginBottom: 24 } },
            React.createElement("p", { style: { fontSize: 11, fontWeight: 700, color: C.dim, letterSpacing: "0.1em",
                    textTransform: "uppercase", marginBottom: 16 } }, "What happens next"),
            React.createElement("div", { className: "g-card", style: { borderColor: C.teal + "60",
                    borderLeft: `4px solid ${C.teal}`, marginBottom: 14 } },
                React.createElement("p", { style: { fontSize: 11, fontWeight: 700, color: C.teal, letterSpacing: "0.08em",
                        textTransform: "uppercase", marginBottom: 8 } }, "Primary option"),
                React.createElement("h3", { style: { fontSize: 18, fontWeight: 700, color: C.text, marginBottom: 8 } }, "Book a free 30-minute discovery call with Joe"),
                React.createElement("p", { style: { fontSize: 14, color: C.muted, lineHeight: 1.65, marginBottom: 20 } }, "Bring your GAP Profile. In 30 minutes, Joe will connect your profile to a specific coaching approach and tell you honestly whether coaching is the right next step."),
                React.createElement("button", { className: "g-btn-p", style: { width: "100%" }, onClick: () => { dispatch({ type: "CLEAR_TOAST" }); window.open("https://cal.com", "_blank"); } }, "Book my discovery call \u2192")),
            React.createElement("div", { className: "g-card", style: { marginBottom: 14 } },
                React.createElement("h3", { style: { fontSize: 16, fontWeight: 600, color: C.text, marginBottom: 6 } }, "Download your full results PDF"),
                React.createElement("p", { style: { fontSize: 14, color: C.muted, lineHeight: 1.6, marginBottom: 14 } }, "Your complete GAP Profile including interpretation guide, archetype detail, and intervention framework \u2014 a reference for your coaching journey."),
                email ? (React.createElement("p", { style: { fontSize: 14, color: C.teal } },
                    "\u2713 Sending to ",
                    email)) : (React.createElement("button", { className: "g-btn-g", style: { width: "100%" }, onClick: () => dispatch({ type: "SET_STEP", step: 6 }) }, "Enter email to receive PDF \u2192"))),
            React.createElement("div", { style: { textAlign: "center" } },
                React.createElement("button", { onClick: () => {
                        const t = `GAP Profile™ Results — ${arch.label}\nCGI: ${cgi}/10\nAction: ${ctx.c1}\ngapprofile.co.uk`;
                        navigator.clipboard.writeText(t).catch(() => { });
                        dispatch({ type: "CLEAR_TOAST" });
                    }, style: { background: "none", border: "none", fontSize: 13,
                        color: C.dim, cursor: "pointer", textDecoration: "underline" } }, "Copy profile summary to clipboard"))),
        React.createElement("div", { className: "g-fu g-d5", style: { marginBottom: 24 } },
            React.createElement(Accordion, { title: "About the GAP Profile\u2122 methodology" },
                React.createElement("div", { style: { display: "flex", flexDirection: "column", gap: 16 } },
                    React.createElement("p", { style: { fontSize: 14, color: C.muted, lineHeight: 1.7 } }, "The GAP Profile\u2122 was developed to address a specific problem: most career assessments tell you about personality or values, but don't explain why people who already know what they should do still don't do it. This diagnostic measures the four evidence-based constructs most predictive of that knowing-doing gap."),
                    Object.values(ARCHETYPES).map(a => (React.createElement("div", { key: a.label, style: { display: "flex", gap: 12, alignItems: "flex-start" } },
                        React.createElement("div", { style: { width: 8, height: 8, borderRadius: 2, background: a.color,
                                flexShrink: 0, marginTop: 5 } }),
                        React.createElement("div", null,
                            React.createElement("p", { style: { fontSize: 13, fontWeight: 700, color: C.text, marginBottom: 2 } }, a.label),
                            React.createElement("p", { style: { fontSize: 12, color: C.muted } },
                                a.theory,
                                " \u2014 ",
                                a.mechanism))))),
                    React.createElement("p", { style: { fontSize: 14, color: C.muted, lineHeight: 1.7, borderTop: `1px solid ${C.border}`, paddingTop: 14 } }, "Joe Markland is a career coach with over 300 hours of coaching practice, specialising in the knowing-doing gap in early-to-mid career professionals. The GAP Profile\u2122 is his proprietary diagnostic instrument, developed from direct work with individuals at this career transition point.")))),
        React.createElement("div", { style: { textAlign: "center" } },
            React.createElement("button", { className: "g-btn-g", onClick: () => { clearSession(); dispatch({ type: "RETAKE" }); } }, "\u2190 Start over")),
        React.createElement("button", { onClick: () => dispatch({ type: "OPEN_COACH" }), style: { position: "fixed", bottom: 24, right: 24, background: C.surf2,
                border: `1px solid ${C.border}`, borderRadius: 10, padding: "10px 16px",
                display: "flex", alignItems: "center", gap: 8, cursor: "pointer",
                fontFamily: "Inter, sans-serif", fontSize: 12, color: C.muted,
                boxShadow: "0 4px 20px rgba(0,0,0,0.4)", transition: "border-color 0.15s, color 0.15s",
                zIndex: 50 }, onMouseEnter: e => { e.currentTarget.style.borderColor = C.teal; e.currentTarget.style.color = C.teal; }, onMouseLeave: e => { e.currentTarget.style.borderColor = C.border; e.currentTarget.style.color = C.muted; } },
            React.createElement("span", { style: { color: C.teal } }, "\u25C8"),
            " Coach")));
}
// ─── ROOT ──────────────────────────────────────────────────────────────────────
function GAPProfile() {
    const [state, dispatch] = useReducer(reducer, INITIAL);
    const isMobile = useIsMobile();
    const styleInjected = useRef(false);
    // Inject CSS once
    useEffect(() => {
        if (document.getElementById("gap-profile-styles"))
            return;
        const el = document.createElement("style");
        el.id = "gap-profile-styles";
        el.textContent = GLOBAL_CSS;
        document.head.appendChild(el);
        styleInjected.current = true;
        return () => {
            const existing = document.getElementById("gap-profile-styles");
            if (existing && styleInjected.current)
                existing.remove();
        };
    }, []);
    // Check for saved session on mount
    useEffect(() => {
        const saved = loadSession();
        if (saved && saved.step > 0) {
            dispatch({ type: "SET_RESUME", val: true });
        }
    }, []);
    // Save session on every state change
    useEffect(() => {
        if (state.step > 0)
            saveSession(state);
    }, [state.step, state.ctx, state.responses, state.email, state.firstName]);
    // Auto-clear toast
    useEffect(() => {
        if (!state.toast)
            return;
        const t = setTimeout(() => dispatch({ type: "CLEAR_TOAST" }), 3000);
        return () => clearTimeout(t);
    }, [state.toast]);
    // Compute scores when reaching results
    useEffect(() => {
        if (state.step === 7 && !state.scores) {
            dispatch({ type: "COMPUTE_SCORES" });
        }
    }, [state.step, state.scores]);
    const sectionIdx = state.step >= 2 && state.step <= 5 ? state.step - 2 : -1;
    return (React.createElement("div", { style: { minHeight: "100vh", background: C.ink, fontFamily: "Inter, sans-serif" } },
        React.createElement(TopNav, { step: state.step, isMobile: isMobile }),
        state.resumeBannerVisible && (React.createElement("div", { style: { background: C.surf2, borderBottom: `1px solid ${C.border}`,
                padding: "12px 24px", display: "flex", alignItems: "center",
                justifyContent: "center", gap: 16 } },
            React.createElement("span", { style: { fontSize: 14, color: C.muted } }, "You have a session in progress."),
            React.createElement("button", { className: "g-btn-p", style: { padding: "8px 18px", fontSize: 13 }, onClick: () => {
                    const saved = loadSession();
                    if (saved)
                        dispatch({ type: "RESUME_SESSION", saved });
                } }, "Resume \u2192"),
            React.createElement("button", { onClick: () => dispatch({ type: "SET_RESUME", val: false }), style: { background: "none", border: "none", color: C.dim,
                    cursor: "pointer", fontSize: 13 } }, "Dismiss"))),
        state.step === 0 && React.createElement(ScreenLanding, { dispatch: dispatch }),
        state.step === 1 && (React.createElement(ScreenContext, { ctx: state.ctx, ctxErrors: state.ctxErrors, dispatch: dispatch })),
        sectionIdx >= 0 && (React.createElement(ScreenSection, { key: state.step, section: SECTIONS[sectionIdx], stepIdx: sectionIdx, responses: state.responses, dispatch: dispatch, isMobile: isMobile })),
        state.step === 6 && (React.createElement(ScreenEmail, { email: state.email, firstName: state.firstName, dispatch: dispatch })),
        state.step === 7 && state.scores && (React.createElement(ScreenResults, { state: state, dispatch: dispatch })),
        state.coachModalOpen && (React.createElement(CoachModal, { state: state, dispatch: dispatch })),
        state.toast && (React.createElement(Toast, { message: state.toast, onDone: () => dispatch({ type: "CLEAR_TOAST" }) }))));
}


    // Mount app
    const container = document.getElementById('root');
    const root = ReactDOM.createRoot(container);
    root.render(React.createElement(GAPProfile));

    // Remove loading screen once React has rendered
    requestAnimationFrame(() => {
      requestAnimationFrame(() => {
        const ld = document.getElementById('loading');
        if (ld) {
          ld.classList.add('fade');
          setTimeout(() => { if (ld.parentNode) ld.parentNode.removeChild(ld); }, 450);
        }
      });
    });
  </script>
</body>
</html>